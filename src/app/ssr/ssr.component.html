<div class="container mt-3">
    <p routerLink="/">
        <a class="pe-auto text-secondary text-decoration-none"> <-Back </a>
    </p>
    <h4>Server-Side Rendering (SSR)</h4>
    <p>Server renders HTML first, sends it to browser.</p>
    <div class="row">
        <div class="col">
            <b>SSR - Server Side Rendering</b>
            <ul>
                <li>Browser requests /products
                </li>
                <li>Node server runs Angular (âœ…Backend will do below the process)
                </li>
                <li>âœ…Fetches data
                </li>
                <li>âœ…Builds HTML
                </li>
                <li>âœ…Sends fully rendered page
                </li>
                <li>Browser shows instantly (Backend will gives the HTML)
                </li>
                <li>Angular hydrates & becomes interactive
                </li>
            </ul>
            <b> ğŸ‘‰ This is called hydration.
            </b>
            <pre class="alert alert-warning">                    <b>ğŸ“Š SSR vs CSR</b>
                
| Feature          | CSR      | SSR        |
| ---------------- | -------- | ---------- |
| First paint      | Slow     | Fast       |
| SEO              | Weak     | Excellent  |
| Social preview   | âŒ        | âœ…       |
| Performance      | JS heavy | HTML first |
| Works without JS | Partial  | Better     |
| Infra complexity | Simple   | More       | </pre>
        </div>
        <div class="col">
            <b>CSR - Client Side Rendering (default Angular)</b>
            <p>Normal Angular app:</p>
            Browser downloads:
            <ul>
                <li>index.html
                </li>
                <li>JS bundles
                </li>
                <li>JS runs
                </li>
                <li>Angular bootstraps
                </li>
                <li>API calls happen
                </li>
                <li>DOM is created
                </li>
            </ul>
            <p>
                User initially sees: <b>Blank page or spinner â†’ then will content appears</b></p>
            <pre>
 âš ï¸ Problems:
SEO bots may not execute JS fully
Slow first paint on bad networks
Bad for social sharing previews
Feels sluggish (à®®à®¨à¯à®¤à®®à®¾à®©)</pre>
            <hr>
            <pre>
ğŸ§  What SSR Actually Solves
SSR improves:
âœ” First Contentful Paint
âœ” SEO
âœ” Social previews
âœ” Perceived speed

<b>It does not remove JavaScript bundles or client logic.</b>
            </pre>
        </div>
    </div>
    <div class="container card alert alert-info">
        <div class="row">
            <h5>Why Companies Use SSR (Real World)?</h5>
            <div class="row">
                <div class="col">
                    <ul>
                        <b>SSR is used when:</b>
                        <li>âœ… Marketing pages : Landing pages, blogs, docs.
                        </li>
                        <li>âœ… E-commerce : Product listings, SEO critical.
                        </li>
                        <li>âœ… News sites : Indexable content.
                        </li>
                        <li>âœ… Public portals : Gov portals, content heavy.
                        </li>
                    </ul>
                    <pre>
    <b>SSR Works in Angular (Architecture)</b>

    Browser â”€â”€â–¶ Node SSR Server
    â”‚
    â”œâ”€ runs Angular app
    â”œâ”€ executes resolvers / services
    â”œâ”€ renders HTML
    â–¼
HTML Response
    â”‚
    â–¼
Browser Hydration (End User View)

            </pre>
                </div>
                <div class="col">
                    <ul>
                        <b> Real world:</b>
                        <li>Amazon â†’ hybrid SSR</li>
                        <li> Airbnb â†’ SSR</li>
                        <li>Netflix landing pages â†’ SSR</li>
                        <li> Angular official docs â†’ SSR</li>
                    </ul>
                    <pre>
                        <b>ğŸ“Š Before SSR vs After SSR</b>

| à®µà®¿à®·à®¯à®®à¯                | SSR à®‡à®²à¯à®²à®¾à®®à®²à¯         | SSR à®‰à®Ÿà®©à¯    
| --------------------    | --------------------    | ----------- 
| à®®à¯à®¤à®²à¯ à®¤à®¿à®°à¯ˆ à®µà¯‡à®•à®®à¯     | à®®à¯†à®¤à¯                  | à®µà¯‡à®•à®®à®¾à®©à®¤à¯    
| SEO                     | à®•à¯à®±à¯ˆà®µà¯                 | à®šà®¿à®±à®ªà¯à®ªà¯     
| à®ªà®•à®¿à®°à¯à®®à¯ à®ªà¯‹à®¤à¯ preview  | à®‡à®²à¯à®²à¯ˆ                | à®‰à®³à¯à®³à®¤à¯      
| à®ªà®¯à®©à®°à¯ à®‰à®£à®°à¯à®µà¯        | à®•à®¾à®¤à¯à®¤à®¿à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯  | à®‰à®Ÿà®©à®Ÿà®¿ à®¤à®•à®µà®²à¯ 
| à®šà¯‡à®µà¯ˆà®¯à®• à®µà¯‡à®²à¯ˆ      | à®•à¯à®±à¯ˆà®µà¯                | à®…à®¤à®¿à®•à®®à¯      
                    </pre>
                    <p><b>ğŸ‘‰ Angular still loads in the browser.</b> <br> SSR only changes the first response. <br> âœ…
                        â€œAngular runs first on server, then again in browser to
                        hydrateâ€</p>
                </div>
            </div>
        </div>
    </div>
    <div class="container card alert alert-warning">
        <h5>Installation</h5>
        <div class="row">
            <div class="col">
                <code>
            ng add &#64;angular/ssr
        </code>
                <pre>

What this does:
âœ” adds Node server (server.ts)
âœ” configures build targets
âœ” enables hydration
âœ” adds SSR scripts
âœ” updates main.ts
        </pre>
            </div>
            <div class="col">
                <b>Package.json</b>
                <img src="../../assets/img/screenshots/ssr-1.png" alt="ssr" height="150px" width="300px">
            </div>
            <div class="col">
                <b>After install ssr - creates below files</b>
                <img src="../../assets/img/screenshots/ssr-2.png" alt="ssr" height="150px" width="300px">
            </div>
        </div>
        <div class="row">
            <div class="col">
                <b>Run in SSR Mode: </b> <br>
                <code>npm run build:ssr</code><br>
                <code>npm run start:ssr</code>
                <p>It will create a dist folder inside that we will have 2 folders </p>
                <pre>
dist/
 â”œâ”€â”€ browser/
 â””â”€â”€ server/
                </pre>
                <div class="row">
                    <div class="col">
                        <b>ğŸ“‚ dist/browser</b>
                        <ul>
                            <li>JS bundles</li>
                            <li>CSS</li>
                            <li>assets</li>
                            <li>index.html</li>
                        </ul>
                    </div>
                    <div class="col">
                        <b>ğŸ“‚ dist/server</b>
                        <ul>
                            <li> main.server.mjs</li>
                            <li> index.server.html</li>
                            <li>server chunks</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col">
                <b>Run in CSR Mode: </b> <br>
                <code>npm run start:csr</code>
                <div class="mt-5">
                    <b>Folder structure:</b><br>
                    <img src="../../assets/img/screenshots/ssr-4.png" height="250px" alt="ssr">
                </div>
            </div>
        </div>
    </div>
    <div class="container card alert alert-primary">
        <h5>CSR Vs SSR</h5>
        <div class="row">
            <div class="col mt-3">
                <b>Client Side Rendering : </b> <span>On page loads its loads the required js files from the
                    sources</span> <br>
                <a href="https://angular-component-interaction.web.app" target="_blank">CSR : angular-component-interaction.web.app</a>
                <br><br>
                <img src="../../assets/img/screenshots/csr.png" height="400px" alt="csr">
            </div>
            <div class="col mt-3">
                <b>Server Side Rendering : </b> <span>Source files are already available in the server folder so, no
                    more extra files loded on page load.</span> <br>
                <a href="https://angular-ssr-4b55e.web.app" target="_blank">SSR : angular-ssr-4b55e.web.app</a>
                <br><br>
                <img src="../../assets/img/screenshots/ssr-3.png" height="400px" alt="csr">
            </div>
        </div>
    </div>
    <div class="container card alert alert-secondary">
        <h5>SSR Deployment</h5>
        <div class="row">
            <h6>ğŸš€ Step-by-Step: Deploy Angular SSR to Firebase Hosting</h6>
            <pre>

ğŸ”µ STEP 1 â€” Install Firebase CLI
Globally:

<b>npm install -g firebase-tools</b>

Login: <b>firebase login</b>

ğŸ”µ STEP 2 â€” Initialize Firebase in Project
From Angular root:

<b>firebase init</b>

Choose:
âœ” Hosting
âœ” Functions âŒ (skip unless needed)
âœ” Use existing project or create new

When asked:
<b>Public directory?</b>
â¡ï¸ dist/angular-interaction/browser

<b>Configure as SPA?</b>
â¡ï¸ âŒ No (because SSR handles routing)

ğŸ”µ STEP 3 â€” Create SSR Container for Cloud Run
<b>Create file at project root:</b>

ğŸ“„ Dockerfile

FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install --omit=dev

COPY dist/angular-interaction ./dist/angular-interaction

EXPOSE 8080

CMD ["node", "dist/angular-interaction/server/server.mjs"]

ğŸ”µ STEP 4 â€” Build Before Deploy
Run:
<b>ng build</b>

dist/angular-interaction/browser
dist/angular-interaction/server
Make sure above folders exist.

ğŸ”µ STEP 5 â€” Configure Firebase Rewrite to Cloud Run
<b>Open firebase.json.</b>

&#123;
  "hosting": &#123;
    "public": "dist/angular-interaction/browser",
    "rewrites": [
      &#123;
        "source": "**",
        "run": &#123;
          "serviceId": "angular-ssr",
          "region": "asia-south1"
        &#125;
      &#125;
    ]
  &#125;
&#125;

ğŸ”µ STEP 6 â€” Deploy to Cloud Run via Firebase
Run:

<b>firebase deploy</b></pre>

            <a href="https://angular-ssr-4b55e.web.app/" target="_blank"> Angular SSR App</a>
        </div>
    </div>
</div>